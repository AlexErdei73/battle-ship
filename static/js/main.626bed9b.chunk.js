(this["webpackJsonpbattle-ship"]=this["webpackJsonpbattle-ship"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n(2),o=n.n(r),a=n(8),c=n.n(a),s=(n(14),n(5)),u=n(1),d=n(3),h=(n(15),n.p+"static/media/battleship.fe5c943a.svg"),l=n.p+"static/media/hit.c844d5aa.png",p=n.p+"static/media/sunk.ba66429c.jpg",f=n.p+"static/media/missed.89c6a26f.png",b=function(e){var t,n="27px",r={position:"relative",left:"-8px",bottom:"0",height:"27px"},o={},a="boardCell";switch(e.content[e.pos]){case"B":t=h,o.backgroundColor="skyblue",o.borderColor="steelblue";break;case"S":t=p,o.borderColor="yellow";break;case"X":t=l,o.backgroundColor="yellow",o.borderColor="red",n="12px",r={};break;case"/":t=f;break;default:t="#",r={},n="27px"}return e.hide?a+=" hide":a+=" show",Object(i.jsx)("button",{className:a,id:e.pos,onClick:e.onClick,onPointerDown:e.onPointerDown,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onDoubleClick:e.onDoubleClick,disabled:e.disabled,style:o,children:Object(i.jsx)("img",{alt:"",src:t,width:n,style:r})},e.pos)},m=function(e){for(var t=[],n=0;n<100;n++)t.push(n);return Object(i.jsx)("div",{className:"board",id:e.id,onMouseLeave:e.onMouseLeave,children:t.map((function(t){return Object(i.jsx)(b,{pos:t,content:e.content,disabled:e.disabled,onClick:e.onClick,hide:e.areBoardCellsHidden[t],onPointerDown:e.onPointerDown,onPointerMove:e.onPointerMove,onPointerUp:e.onPointerUp,onDoubleClick:e.onDoubleClick},t)}))})},v=function(e){return Object(i.jsxs)("div",{className:"titleBar",children:[Object(i.jsx)("h1",{className:e.isTitleInView?"center":"",children:e.text}),Object(i.jsx)("div",{className:"left",children:Object(i.jsx)("h1",{className:"playerScore",children:e.playerScore})}),Object(i.jsx)("div",{className:"right",children:Object(i.jsx)("h1",{className:"computerScore",children:e.computerScore})})]})},j=function(e){var t="info";return e.hide?t+=" hide":t+=" show",Object(i.jsx)("div",{className:t,id:"usage",children:Object(i.jsx)("p",{children:"You can drag and drop your ships to their place. Use double click to rotate the ships. The program maintains 2 cells distance between the ships and keeps them on the game board."})})},x=function(e,t){return e.findIndex((function(e){return e.x===t.x&&e.y===t.y}))};function y(){return{x:Math.floor(10*Math.random()),y:Math.floor(10*Math.random())}}function O(e){var t=e.x;return 10*(9-e.y)+t}function g(e){return{x:e%10,y:9-Math.floor(e/10)}}function S(e,t){for(var n=[],i=0;i<100;i++)n.push(" ");return e.missedShots.forEach((function(e){var t=O(e);n[t]="/"})),e.ships.forEach((function(e){e.isSunk()?e.getCoordinates().forEach((function(e){var t=O(e);n[t]="S"})):(t&&e.getCoordinates().forEach((function(e){var t=O(e);n[t]="B"})),e.getDamages().forEach((function(e){var t=O(e);n[t]="X"})))})),n}function k(e){return{playerBoard:S(e.player.board,!0),enemyBoard:S(e.computer.board,!1)}}function w(e){e.placeShips(e.player.board,[{position:{x:1,y:2},direction:90},{position:{x:4,y:4},direction:0},{position:{x:4,y:9},direction:0},{position:{x:4,y:1},direction:0},{position:{x:8,y:7},direction:90},{position:{x:5,y:7},direction:0},{position:{x:8,y:1},direction:0}]),e.placeShipsRandom(e.computer.board)}function C(){for(var e=[],t=0;t<100;t++)e.push(!0);return e}function N(e,t){if(-1===e.indexOf(!t))return e;var n;do{n=O(y())}while(e[n]!==!t);return e[n]=t,e}function M(e,t){return e.ships.map((function(e){var n=e.getCoordinates();return x(n,t)})).findIndex((function(e){return-1!==e}))}function P(e,t){var n={};return n.x=e.x+t.x,n.y=e.y+t.y,n}function B(e,t){e.ships.splice(t,1),e.changeShipLengths(t)}var E=function(){var e=this;this.name="",this.enemy={},this.board={},this.attack=function(t){var n,i=e.enemy.board.missedShots,r=!1,o=!1;return-1!==x(i,t)?{success:r,hit:o}:(n=t,-1!==e.enemy.board.ships.map((function(e){return!(-1===x(e.getDamages(),n))})).indexOf(!0)?{success:r,hit:o}:{success:r=!0,hit:o=e.enemy.board.receiveAttack(t)})},this.autoAttack=function(t){var n={};do{n=e.attack(t())}while(!n.success);return n}};var D=function(e,t,n){var i=e,r=t,o=n,a=[],c=[];this.hit=function(e){if(-1!==x(c,e))return!1;var t,n=x(a,e);return-1!==n&&(t=n,c.push(Object(u.a)({},a[t])),!0)};var d=function(){a=[],c=[];for(var e=Object(u.a)({},function(){var e={dx:0,dy:0};switch(r){case 0:e={dx:1,dy:0};break;case 90:e={dx:0,dy:1};break;case 180:e={dx:-1,dy:0};break;case 270:e={dx:0,dy:-1}}return e}()),t=e.dx,n=e.dy,s=Object(u.a)({},i),d=0;d<o;d++)a.push(Object(u.a)({},s)),s.x+=t,s.y+=n};this.getCoordinates=function(){return Object(s.a)(a)},this.getDamages=function(){return Object(s.a)(c)},this.isSunk=function(){return c.length===o},Object.assign(this,{get position(){return i},set position(e){i.x=e.x,i.y=e.y,d()},get direction(){return r},set direction(e){r=e,d()},get length(){return o},set length(e){o=e,d()}}),d()};var A=function(){var e=this;this.ships=[],this.missedShots=[];var t=[5,4,3,2,2,1,1],n=function(e){var t=Object(u.a)({},e),n=t.x,i=t.y;return n>=0&&n<10&&i>=0&&i<10},i=function(e){return e.reduce((function(e,t){return t<e?t:e}),e[0])},r=function(e,t){var n=e.getCoordinates().map((function(e){return function(e,t){var n=Object(u.a)({},e),r=n.x,o=n.y,a=t.getCoordinates().map((function(e){return Math.pow(r-e.x,2)+Math.pow(o-e.y,2)}));return Math.sqrt(i(a))}(e,t)}));return i(n)};this.placeShip=function(o,a){var c=t[e.ships.length],s=new D(o,a,c),u=function(e){return-1===e.getCoordinates().map((function(e){return n(e)})).indexOf(!1)}(s),d=function(e,t){var n=t.map((function(t){return r(e,t)}));return i(n)}(s,e.ships)>=2||0===e.ships.length,h=u&&d;return h&&e.ships.push(s),h},this.receiveAttack=function(t){return!!n(t)&&(-1!==(i=t,e.ships.map((function(e){return e.hit(i)})).indexOf(!0))||(-1!==x(e.missedShots,t)&&0!==e.missedShots.length||e.missedShots.push(Object(u.a)({},t)),!1));var i},this.isAllShipSunk=function(){return-1===e.ships.map((function(e){return e.isSunk()})).indexOf(!1)},this.changeShipLengths=function(e){var n=t.splice(e,1);t.push(n)}};var T=function(){var e=this;this.player=new E,this.player.name="player",this.player.board=new A,this.computer=new E,this.computer.name="computer",this.computer.board=new A,this.player.enemy=this.computer,this.computer.enemy=this.player,this.setState=function(){},this.placeShips=function(e,t){t.forEach((function(t){e.placeShip(t.position,t.direction)}))},this.placeShipsRandom=function(e){for(var t=0;t<7;t++)for(;!e.placeShip(y(),90*Math.floor(4*Math.random())););},this.playerAttack=function(t){var n=e.player.attack(t),i=!1,r={};if(!n.success)return{gameOver:i,winner:r};if(e.setState(k(e)),n.hit)(i=e.computer.board.isAllShipSunk())&&(r=e.player);else do{n=e.computer.autoAttack(y),e.setState(k(e)),(i=e.player.board.isAllShipSunk())&&(r=e.computer)}while(n.hit&&!i);return{gameOver:i,winner:r}}},I=new T;w(I);var L,U,R=k(I),F={gameOver:!0,winner:""},H="BATTLESHIP",V=!1,X=!0,G={},J=!1;var W=function(){var e=Object(r.useState)(R),t=Object(d.a)(e,2),n=t[0],o=t[1],a=Object(r.useState)({player:0,computer:0}),c=Object(d.a)(a,2),h=c[0],l=c[1],p=Object(r.useState)(!1),f=Object(d.a)(p,2),b=f[0],x=f[1],y=Object(r.useState)(!1),S=Object(d.a)(y,2),E=S[0],D=S[1],A=function(e){if(J){var t=I.player.board,n=P(G.position,U);t.placeShip(n,G.direction)||t.placeShip(G.position,G.direction),J=!1,o(k(I))}};I.setState=o;var W=Object(r.useState)(C()),Y=Object(d.a)(W,2),q=Y[0],z=Y[1],K=function(){-1!==q.indexOf(!V)&&setTimeout((function(){var e=N(N(Object(s.a)(q),V),V);z(e)}),50)};return Object(r.useEffect)(K,[q]),Object(r.useEffect)((function(){x(!0)}),[]),Object(i.jsxs)("div",{children:[Object(i.jsx)(v,{isTitleInView:b,playerScore:h.player,computerScore:h.computer,text:H}),Object(i.jsxs)("div",{className:"gameArea",children:[Object(i.jsx)("h1",{className:"info",id:"winner",children:F.winner.name?"WINNER: ".concat(F.winner.name.toUpperCase()):"WINNER:"}),Object(i.jsxs)("div",{className:"boardContainer",children:[Object(i.jsx)("button",{className:"gameControl",onClick:function(){E?(X=!1,w(I=new T),F={gameOver:!0,winner:""},V=!0,x(!1),K(),setTimeout((function(){H="BATTLESHIP",V=!1,z(C()),X=!0,o(R),x(!0),D(!1)}),4e3)):(X=!1,F.gameOver=!1,D(!0))},disabled:!X,children:E?"New Game":"Start"}),Object(i.jsx)(m,{id:"player",content:n.playerBoard,disabled:E,areBoardCellsHidden:q,onPointerDown:function(e){var t=g(Number(e.currentTarget.id)),n=I.player.board,i=n.ships,r=M(n,t);if(-1!==r){var o=i[r];G.position=Object(u.a)({},o.position),G.direction=o.direction,G.length=o.length,G.coordinates=o.getCoordinates(),L=Object(u.a)({},t),B(n,r),J=!0}},onPointerMove:function(e){if(J){var t,n=document.elementFromPoint(e.clientX,e.clientY);n&&-1!==n.className.indexOf("boardCell")?t=g(Number(n.id)):(t=L,J=!1,I.player.board.placeShip(G.position,G.direction)),U=P(t,function(e){var t={};return t.x=-e.x,t.y=-e.y,t}(L));var i=k(I),r=i.playerBoard;G.coordinates.forEach((function(e){var t=P(e,U),n=O(t);t.x>=0&&t.x<10&&t.y>=0&&t.y<10&&(r[n]="B")})),o(i)}},onPointerUp:A,onMouseLeave:A,onDoubleClick:function(e){A();var t=g(Number(e.currentTarget.id)),n=I.player.board,i=n.ships,r=M(n,t);if(-1!==r){var a=i[r],c=a.direction,s=a.position,u=(c+90)%360;B(n,r),n.placeShip(s,u)||n.placeShip(s,c),o(k(I))}}})]}),Object(i.jsxs)("div",{className:"boardContainer",children:[Object(i.jsx)("button",{className:"gameControl",children:"Reset"}),Object(i.jsx)(m,{id:"computer",content:n.enemyBoard,disabled:F.gameOver,onClick:function(e){var t=e.target.id;if(t){var n=I.playerAttack(g(t));if(F=Object(u.a)({},n),n.gameOver){var i=Object(u.a)({},h);i[n.winner.name]+=1,l(i),H="GAME OVER",X=!0}}},areBoardCellsHidden:q})]}),Object(i.jsx)(j,{hide:!X&&E})]})]})},Y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,o=t.getLCP,a=t.getTTFB;n(e),i(e),r(e),o(e),a(e)}))};c.a.render(Object(i.jsx)(o.a.StrictMode,{children:Object(i.jsx)(W,{})}),document.getElementById("root")),Y()}},[[16,1,2]]]);
//# sourceMappingURL=main.626bed9b.chunk.js.map